<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Control Financiero SV ‚Äî Dark Neon Red</title>

<!-- Fuente moderna -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
/* =============================== */
/*      üéá ESTILO NEON ROJO        */
/* =============================== */
:root {
    --bg: #0a0a0a;
    --card: #131313;
    --text: #e5e5e5;
    --text-soft: #8b8b8b;
    --neon: #ff1a3c;
    --neon-soft: #ff3955;
    --round: 18px;
    --shadow-neon: 0 0 12px rgba(255, 36, 73, 0.45);
}

* { margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif; }

body {
    background: var(--bg);
    color: var(--text);
    padding-bottom: 100px;
}

/* TARJETAS NEON */
.card {
    background: var(--card);
    padding: 18px;
    margin: 15px;
    border-radius: var(--round);
    box-shadow: 0 0 10px rgba(255,0,0,0.08);
    border: 1px solid #1a1a1a;
}

/* TITULOS */
h1, h2, h3, h4 {
    color: var(--text);
    letter-spacing: 0.5px;
}

/* HEADER */
header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:20px;
}
header h1 {
    font-size: 1.6rem;
    font-weight: 800;
}

/* HERO NEON */
.hero {
    background: linear-gradient(135deg, #1a1a1a, #0f0f0f);
    border: 1px solid rgba(255, 45, 69, 0.5);
    box-shadow: 0 0 20px rgba(255, 20, 50, 0.3);
    color: white;
    padding: 25px;
    border-radius: 22px;
    margin: 15px;
}

.hero-amount {
    font-size: 2.7rem;
    font-weight: 800;
    margin-top: 10px;
    text-shadow: 0 0 12px rgba(255, 45, 69, 0.6);
}

/* BOTON NEON */
.btn-neon {
    width:100%;
    padding: 14px;
    border-radius: var(--round);
    border:none;
    cursor:pointer;
    background: var(--neon);
    color:white;
    box-shadow: var(--shadow-neon);
    font-size:1rem;
    margin-top:10px;
    font-weight:700;
    letter-spacing:1px;
}
.btn-neon:hover {
    background: var(--neon-soft);
    box-shadow: 0 0 20px rgba(255, 36, 73, 0.6);
}

/* NAVBAR */
.navbar {
    position: fixed;
    bottom: 0;
    background:#111;
    height:70px;
    width:100%;
    display:flex;
    justify-content:space-around;
    align-items:center;
    border-top:1px solid #222;
}
.nav-item {
    text-align:center;
    font-size:0.75rem;
    color: var(--text-soft);
}
.nav-item.active { color: var(--neon); }

/* LISTA */
.list-item {
    padding:15px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-bottom:1px solid #222;
}
.list-item:last-child { border:none; }

.item-amount {
    font-weight:bold;
}

/* FAB */
.fab {
    position:fixed;
    right:20px;
    bottom:95px;
    width:60px;
    height:60px;
    background:var(--neon);
    border:none;
    border-radius:50%;
    color:white;
    font-size:32px;
    display:flex;
    justify-content:center;
    align-items:center;
    cursor:pointer;
    box-shadow:var(--shadow-neon);
}

/* MODAL */
.modal-overlay {
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.65);
    display:none;
    justify-content:flex-end;
}
.modal-overlay.open { display:flex; }
.modal {
    background:#111;
    width:100%;
    padding:25px;
    border-radius:25px 25px 0 0;
    height:80vh;
    overflow-y:auto;
    box-shadow:0 0 20px rgba(255,20,50,0.2);
}

/* INPUTS */
.input {
    width:100%;
    padding:13px;
    border-radius:12px;
    border:1px solid #222;
    background:#1a1a1a;
    color:white;
    margin-bottom:15px;
}

/* TABS */
.tabs { display:flex; background:#1b1b1b; padding:6px; border-radius:14px; }
.tab {
    flex:1;
    text-align:center;
    padding:10px;
    border-radius:10px;
    color:#888;
    cursor:pointer;
}
.tab.active { background:#000; color:var(--neon); font-weight:600; }

/* DEUDAS */
.progress {
    height:6px;
    width:100%;
    background:#222;
    border-radius:3px;
    margin: 8px 0;
}
.progress div {
    height:100%;
    background:var(--neon);
    border-radius:3px;
    box-shadow:0 0 10px rgba(255, 36, 73, 0.8);
}
</style>
</head>

<body>

<!-- ===================================== -->
<!--         üü• DASHBOARD PRINCIPAL        -->
<!-- ===================================== -->
<section id="view-dash">
<header>
    <h1>Mi Finanzas</h1>
    <button onclick="openConfig()" style="color:var(--neon); background:none; border:none;">‚öôÔ∏è</button>
</header>

<div class="hero">
    <span style="opacity:.85;">Disponible Real</span>
    <div id="displayBalance" class="hero-amount">$0.00</div>
</div>

<h3 style="padding-left:20px; margin-bottom:10px;">Sugerencias 50/50</h3>
<div class="card" id="suggestionList"></div>

<h3 style="padding-left:20px; margin-top:20px;">Deudas y Plazos</h3>
<div class="card" id="debtsList"></div>
</section>

<!-- ===================================== -->
<!--               üìú HISTORIAL            -->
<!-- ===================================== -->
<section id="view-history" style="display:none;">
<header>
    <h1>Historial</h1>
    <button onclick="clearHistory()" style="color:var(--neon); background:none; border:none;">Borrar</button>
</header>
<div class="card" id="transactionList"></div>
</section>

<!-- ===================================== -->
<!--                 ‚ûï FAB                 -->
<!-- ===================================== -->
<button class="fab" onclick="openAddModal()">+</button>

<!-- ===================================== -->
<!--              MODAL NUEVO              -->
<!-- ===================================== -->
<div class="modal-overlay" id="addModal">
    <div class="modal">

        <h2 style="text-align:center;">Nuevo Registro</h2>

        <div class="tabs">
            <div class="tab active" onclick="setTab('expense', this)">Gasto</div>
            <div class="tab" onclick="setTab('debt', this)">Deuda</div>
            <div class="tab" onclick="setTab('fixed', this)">Fijo</div>
        </div>

        <!-- FORMULARIOS -->
        <div id="form-expense">
            <input id="exDesc" class="input" type="text" placeholder="Concepto">
            <input id="exAmount" class="input" type="number" placeholder="Monto">
            <button class="btn-neon" onclick="addTransaction()">Registrar</button>
        </div>

        <div id="form-debt" style="display:none;">
            <input id="debtName" class="input" type="text" placeholder="Art√≠culo">
            <input id="debtTotal" class="input" type="number" placeholder="Valor total">
            <input id="debtMonths" class="input" type="number" placeholder="Meses">
            <input id="debtStart" class="input" type="date">
            <input id="debtPaid" class="input" type="number" value="0">
            <button class="btn-neon" onclick="addDebt()">Guardar Deuda</button>
        </div>

        <div id="form-fixed" style="display:none;">
            <input id="fixName" class="input" type="text" placeholder="Nombre">
            <input id="fixAmount" class="input" type="number" placeholder="Monto mensual">
            <input id="fixDay" class="input" type="number" placeholder="D√≠a l√≠mite">
            <button class="btn-neon" onclick="addFixed()">Guardar Fijo</button>
        </div>

        <button onclick="closeModal('addModal')" style="margin-top:20px; background:none; border:none; color:#777;">Cancelar</button>
    </div>
</div>

<!-- ===================================== -->
<!--           ‚öôÔ∏è MODAL CONFIG              -->
<!-- ===================================== -->
<div class="modal-overlay" id="configModal">
    <div class="modal">
        <h2>Configurar Salario</h2>
        <input id="confNominal" class="input" type="number" placeholder="Salario bruto">
        <input id="confManual" class="input" type="number" placeholder="Correcci√≥n manual">
        <button class="btn-neon" onclick="saveSalaryConfig()">Guardar</button>
        <button onclick="closeModal('configModal')" style="background:none; border:none; margin-top:20px; color:#777;">Cerrar</button>
    </div>
</div>

<!-- ===================================== -->
<!--             JS OPTIMIZADO             -->
<!-- ===================================== -->
<script>

let data = {
    salaryBruto:0,
    salaryManual:0,
    balance:0,
    expenses:[],
    debts:[],
    transactions:[]
};

if(localStorage.getItem("finred")){
    data = JSON.parse(localStorage.getItem("finred"));
}

init();

/* ========================== */
/*      FUNCIONES BASE        */
/* ========================== */
function init(){
    updateDashboard();
    renderHistory();
}

function save(){
    localStorage.setItem("finred", JSON.stringify(data));
}

/* ========================== */
/*     SALARIO Y DISPLAY      */
/* ========================== */
function getSalary(){
    if(data.salaryManual>0){
        return {liq:data.salaryManual};
    }
    const n = data.salaryBruto;
    const isss = Math.min(n,1000)*0.03;
    const afp = n*0.0725;
    let renta=0;
    const t = n - isss - afp;
    if(t>472 && t<=895.24) renta=((t-472)*0.1)+17.67;
    else if(t>895.24 && t<=2038.10) renta=((t-895.24)*0.2)+60;
    else if(t>2038.10) renta=((t-2038.10)*0.3)+288.57;
    return {liq:t-renta};
}

function updateDashboard(){
    document.getElementById("displayBalance").innerText = "$"+data.balance.toFixed(2);
    renderSuggestions();
    renderDebts();
}

/* ========================== */
/*       GASTOS FIJOS         */
/* ========================== */
function renderSuggestions(){
    let cont = document.getElementById("suggestionList");
    cont.innerHTML = "";
    if(data.expenses.length===0){
        cont.innerHTML="<div style='text-align:center;color:#666;'>Sin gastos fijos.</div>";
        return;
    }
    data.expenses.forEach(e=>{
        let div=document.createElement("div");
        div.className="list-item";
        div.innerHTML=`<div><strong>${e.name}</strong><br><small style='color:#777;'>D√≠a ${e.day}</small></div>
                       <div class="item-amount" style="color:var(--neon);">$${e.amount.toFixed(2)}</div>`;
        cont.appendChild(div);
    });
}

/* ========================== */
/*           DEUDAS           */
/* ========================== */
function renderDebts(){
    let cont=document.getElementById("debtsList");
    cont.innerHTML="";
    if(data.debts.length===0){
        cont.innerHTML="<div style='text-align:center;color:#666;'>No hay deudas activas.</div>";
        return;
    }
    data.debts.forEach((d,i)=>{
        const cuota=d.total/d.months;
        const prog=(d.paid/d.months)*100;

        let div=document.createElement("div");
        div.className="list-item";
        div.style.flexDirection="column";
        div.style.alignItems="flex-start";

        div.innerHTML=`
            <div style="width:100%; display:flex; justify-content:space-between;">
                <strong>${d.name}</strong>
                <button onclick="payInstallment(${i})" style="background:none;border:none;color:var(--neon);font-size:.9rem;">Pagar</button>
            </div>

            <small style="color:#777;">${d.paid}/${d.months} cuotas</small>

            <div class="progress"><div style="width:${prog}%"></div></div>

            <small style="color:#999;">Cuota: $${cuota.toFixed(2)}</small>
        `;

        cont.appendChild(div);
    });
}

/* ========================== */
/*         GASTO NORMAL       */
/* ========================== */
function addTransaction(){
    let d=document.getElementById("exDesc").value;
    let a=parseFloat(document.getElementById("exAmount").value);
    if(!d||!a) return;

    data.balance -= a;
    data.transactions.unshift({
        desc:d,
        amount:-a,
        date:new Date().toLocaleDateString()
    });

    save();
    closeModal("addModal");
    init();
}

/* ========================== */
/*           DEUDAS           */
/* ========================== */
function addDebt(){
    const n=document.getElementById("debtName").value;
    const t=parseFloat(document.getElementById("debtTotal").value);
    const m=parseInt(document.getElementById("debtMonths").value);
    const s=document.getElementById("debtStart").value;
    const p=parseInt(document.getElementById("debtPaid").value)||0;

    if(!n||!t||!m||!s) return;

    data.debts.push({name:n,total:t,months:m,startDate:s,paid:p});
    save();
    closeModal("addModal");
    init();
}

function payInstallment(i){
    let d=data.debts[i];
    const cuota=d.total/d.months;
    if(d.paid>=d.months) return alert("Deuda ya finalizada.");

    d.paid++;
    data.balance -= cuota;

    data.transactions.unshift({
        desc:"Cuota "+d.name,
        amount:-cuota,
        date:new Date().toLocaleDateString()
    });

    save();
    init();
}

/* ========================== */
/*        GASTO FIJO          */
/* ========================== */
function addFixed(){
    const n=document.getElementById("fixName").value;
    const a=parseFloat(document.getElementById("fixAmount").value);
    const d=parseInt(document.getElementById("fixDay").value);
    if(!n||!a||!d) return;

    data.expenses.push({name:n,amount:a,day:d});
    save();
    closeModal("addModal");
    init();
}

/* ========================== */
/*         HISTORIAL          */
/* ========================== */
function renderHistory(){
    const cont=document.getElementById("transactionList");
    cont.innerHTML="";
    if(data.transactions.length===0){
        cont.innerHTML="<div style='text-align:center;color:#666;'>Sin movimientos.</div>";
        return;
    }
    data.transactions.forEach(t=>{
        let div=document.createElement("div");
        div.className="list-item";
        div.innerHTML=`
            <div>
                <strong>${t.desc}</strong><br>
                <small style="color:#777;">${t.date}</small>
            </div>
            <div style="color:${t.amount<0?'var(--neon)':'#0f0'}; font-weight:bold;">
                ${t.amount.toFixed(2)}
            </div>
        `;
        cont.appendChild(div);
    });
}
function clearHistory(){
    if(confirm("¬øLimpiar historial?")){
        data.transactions=[];
        data.balance=0;
        save();
        init();
    }
}

/* ========================== */
/*           MODALES          */
/* ========================== */
function openAddModal(){ document.getElementById("addModal").classList.add("open"); }
function closeModal(id){ document.getElementById(id).classList.remove("open"); }
function openConfig(){
    document.getElementById("confNominal").value=data.salaryBruto;
    document.getElementById("confManual").value=data.salaryManual;
    document.getElementById("configModal").classList.add("open");
}

/* ========================== */
/*             TABS           */
/* ========================== */
function setTab(t,el){
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
    el.classList.add("active");

    document.getElementById("form-expense").style.display="none";
    document.getElementById("form-debt").style.display="none";
    document.getElementById("form-fixed").style.display="none";

    document.getElementById("form-"+t).style.display="block";
}

/* ========================== */
/*          NAVEGACI√ìN        */
/* ========================== */
function switchView(view){
    document.getElementById("view-dash").style.display="none";
    document.getElementById("view-history").style.display="none";

    document.getElementById("view-"+view).style.display="block";
}

/* ========================== */
/*         SALARIO SAVE       */
/* ========================== */
function saveSalaryConfig(){
    let n=parseFloat(document.getElementById("confNominal").value);
    let m=parseFloat(document.getElementById("confManual").value);

    if(n) data.salaryBruto=n;
    data.salaryManual=m||0;

    save();
    closeModal("configModal");
    updateDashboard();
}
</script>

</body>
</html>
